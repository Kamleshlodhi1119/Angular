<app-header></app-header>

<div class="product-details">
  <!-- LEFT: Image Gallery -->
  <div class="image-gallery">
    <div class="main-image">
      <img [src]="'http://localhost:8080/products/' + product.id + '.jpg'" alt="{{ product.name }}" />
    </div>
    <div class="thumbnails">
      <img [src]="'http://localhost:8080/products/' + product.id + '.jpg'" alt="{{ product.name }}" />
    </div>
  </div>

  <!-- RIGHT: Product Info -->
  <div class="details-section">
    <span class="badge">CONSTRUCTION</span>
    <div class="rating">★ ★ ★ ★ ☆ <span>{{ feedbacks.length }} Reviews</span></div>
    <div class="rating"><span>{{ product?.category }}</span></div>
    <h2>{{ product?.name }}</h2>

    <div class="price">
      <span class="original">$30.35</span>
      <span class="sale">${{ product?.price }}</span>
    </div>

    <p class="short-desc">
      <span class="sale">{{ product?.description }}</span>
    </p>

    <div class="quantity-section">
      <button (click)="decrement()">−</button>
      <span>{{ quantity }}</span>
      <button (click)="increment()">+</button>
    </div>

    <button class="add-cart-btn" (click)="handleAddToCart(product)">ADD TO CART</button>

    <div class="product-meta">
      <p><strong>SKU:</strong> {{ product?.sku }}</p>
      <p><strong>Categories:</strong> {{ product?.categoryList?.join(', ') }}</p>
      <p><strong>Tags:</strong> {{ product?.tags?.join(', ') }}</p>
    </div>

    <div class="social">
      <span>Share:</span>
      <i class="fa fa-facebook"></i>
      <i class="fa fa-twitter"></i>
      <i class="fa fa-instagram"></i>
      <i class="fa fa-linkedin"></i>
    </div>
  </div>
</div>

<!-- ✅ Tabs Section -->
<div class="tabs">
  <button [class.active]="activeTab === 'description'" (click)="setTab('description')">
    DESCRIPTION
  </button>
  <button [class.active]="activeTab === 'additional'" (click)="setTab('additional')">
    ADDITIONAL INFORMATION
  </button>
  <button [class.active]="activeTab === 'reviews'" (click)="setTab('reviews')">
    REVIEWS ({{ feedbacks.length }})
  </button>

  <!-- Tab Content -->
  <div class="tab-content" *ngIf="activeTab === 'description'">
    <p>
      In marketing a product is an object or system made available for consumer use.
      Products are often referred to as merchandise...
    </p>
  </div>

  <div class="tab-content" *ngIf="activeTab === 'additional'">
    <p><strong>Material:</strong> Cotton, Polyester</p>
    <p><strong>Weight:</strong> 1.2kg</p>
  </div>

  <div class="tab-content" *ngIf="activeTab === 'reviews'">
    <div class="feedback-section">
      <h3>{{ feedbacks.length }} Reviews for "{{ product?.name }}"</h3>

      <div *ngIf="feedbacks.length === 0" class="no-feedback">
        No feedback yet.
      </div>

      <div *ngFor="let fb of feedbacks" class="feedback-item">
        <div class="feedback-left">
          <!-- Inline SVG Avatar -->
          <svg class="avatar" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <circle cx="12" cy="7" r="5" />
            <path d="M12 14c-5 0-9 2.5-9 5.5V22h18v-2.5c0-3-4-5.5-9-5.5z"/>
          </svg>
        </div>

        <div class="feedback-right">
          <div class="feedback-header">
            <div>
              <strong class="customer-name">{{ fb.customer.name | uppercase }}</strong>
              <div class="feedback-date">{{ fb.feedbackDate | date:'MMMM d, y, h:mm a' }}</div>
            </div>
            <div class="rating">
              <ng-container *ngFor="let star of [1,2,3,4,5]">
                <i class="fa" [ngClass]="star <= fb.rating ? 'fa-star' : 'fa-star-o'"></i>
              </ng-container>
            </div>
          </div>
          <p class="feedback-text">{{ fb.description }}</p>
        </div>
      </div>
    </div>
  </div>
</div>

<app-footer></app-footer>
